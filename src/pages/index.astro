---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import '../styles/global.css';

const response = await fetch('https://bejamas.io/api/blog?category=case-studies');
const data = await response.json();
const posts = data?.posts;
const blogs = await Astro.glob('../pages/blog/*.md');
---

<Layout title="Welcome to Astro.">
    <div>
        <main>
            <h1>Welcome to <span class="text-gradient">Astro</span></h1>
            <p class="instructions">
                To get started, open the directory <code>src/pages</code> in your project.<br/>
                <strong>Code Challenge:</strong> Tweak the "Welcome to Astro" message above.
            </p>
            <ul role="list" class="link-card-grid">
                <Card href="/about"
                      title="About"
                      body="Learn more about Astro and what makes it special."
                />
                <Card
                        href="https://docs.astro.build/"
                        title="Documentation"
                        body="Learn how Astro works and explore the official API docs."
                />
                <Card
                        href="https://astro.build/integrations/"
                        title="Integrations"
                        body="Supercharge your project with new frameworks and libraries."
                />
                <Card
                        href="https://astro.build/themes/"
                        title="Themes"
                        body="Explore a galaxy of community-built starter themes."
                />
                <Card
                        href="https://astro.build/chat/"
                        title="Community"
                        body="Come say hi to our amazing Discord community. ❤️"
                />
            </ul>
        </main>
        <section class="section blog-section" id="blog-section">
            <div class="container">
                <h2 class="section-title">Our Blog</h2>
                <ul class="blogs">
                    {blogs.map((blog) =>
                            <li>
                                <article class="blog">
                                    <img src={blog.frontmatter.image.url} alt="blog.frontmatter.image.alt" />
                                    <h3>{blog.frontmatter.title}</h3>
                                    <p>{blog.frontmatter.description}</p>
                                    <a href={blog.url} class="">Read more</a>
                                </article>
                            </li>
                        )}
                        </ul>
                        </div>
                        </section>
        <section class="section" id="casestudies-section">
            <div class="container">
                <h2 class="section-title">Case studies</h2>
                <ul class="case-studies">
                    {posts.map((post) => (
                            <li>
                                <article class="casestudy">
                                    <img src={post.mainImage.asset.url} alt=""/>
                                    <div>
                                        <h3>{post.title}</h3>
                                        <p>{post.excerpt}</p>
                                        <a href={`https://bejamas.io/blog/${post.slug}`} class="">Read more</a>
                                    </div>
                                </article>
                            </li>
                        ))}
                        </ul>
                        </div>
                        </section></div>
</Layout>

<style>

</style>
